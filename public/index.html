<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Patient Codex</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body data-api-base="/api">
    <header>
      <h1>Clinician Intake Console</h1>
      <p class="tagline">Live session wiring for the wound-care agent stack.</p>
      <button type="button" id="new-session" class="utility">New session</button>
    </header>

    <main>
      <section class="panel">
        <div class="panel-header">
          <h2>Patient Bio Intake</h2>
          <span id="record-meta" class="meta"></span>
        </div>
        <p class="lead">Choose your input method: form, voice recording, or document scanning.</p>

        <!-- Input Method Selection -->
        <div class="input-method-selector">
          <h3>How would you like to provide patient information?</h3>
          <div class="method-options">
            <button type="button" class="method-option active" data-method="text">
              <span class="icon">üìù</span>
              <span class="title">Text Input</span>
              <span class="desc">Fill out the form manually</span>
            </button>
            <button type="button" class="method-option" data-method="audio">
              <span class="icon">üé§</span>
              <span class="title">Voice Recording</span>
              <span class="desc">Record patient information</span>
            </button>
            <button type="button" class="method-option" data-method="ocr">
              <span class="icon">üì∑</span>
              <span class="title">Document Scan</span>
              <span class="desc">Upload ID card or form</span>
            </button>
          </div>
        </div>

        <!-- Text Input Form (default) -->
        <form id="bio-form" autocomplete="off" class="input-panel active">
          <div class="grid">
            <label>
              <span>ID Number *</span>
              <input name="idNumber" type="text" maxlength="20" required />
            </label>
            <label>
              <span>First name</span>
              <input name="firstName" type="text" maxlength="60" />
            </label>
            <label>
              <span>Last name</span>
              <input name="lastName" type="text" maxlength="60" />
            </label>
            <label>
              <span>Gender</span>
              <select name="gender">
                <option value="">Select gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
                <option value="prefer-not-to-say">Prefer not to say</option>
              </select>
            </label>
            <label>
              <span>Contact number</span>
              <input name="contactNumber" type="tel" maxlength="20" />
            </label>
            <label>
              <span>Date of birth</span>
              <input name="dateOfBirth" type="date" />
            </label>
            <label>
              <span>Age</span>
              <input name="age" type="number" min="0" max="120" />
            </label>
            <label>
              <span>Preferred name</span>
              <input name="preferredName" type="text" maxlength="60" />
            </label>
            <label>
              <span>MRN</span>
              <input name="mrn" type="text" maxlength="50" />
            </label>
          </div>

          <label class="stacked">
            <span>Address</span>
            <textarea name="address" rows="3" placeholder="Street address, city, postal code"></textarea>
          </label>

          <label class="stacked">
            <span>Clinical notes</span>
            <textarea name="notes" rows="4" placeholder="One note per line"></textarea>
          </label>

          <fieldset>
            <legend>Consent</legend>
            <label class="checkbox">
              <input name="dataStorage" type="checkbox" />
              <span>Patient approves secure data storage</span>
            </label>
            <label class="checkbox">
              <input name="photography" type="checkbox" />
              <span>Patient approves wound photography</span>
            </label>
            <label class="checkbox">
              <input name="sharingToTeamBoard" type="checkbox" />
              <span>Share to team board for clinical review</span>
            </label>
            <span id="consent-status" class="badge" data-state="pending">Consent pending</span>
          </fieldset>

          <div class="actions">
            <button type="button" id="confirm-bio">Confirm bio intake</button>
            <span id="save-status" class="status">Ready to save bio data</span>
          </div>
        </form>

        <!-- Audio Input Panel -->
        <div id="audio-panel" class="input-panel">
          <div class="audio-recorder">
            <h3>Voice Recording</h3>
            <p>Click record and describe the patient information clearly.</p>
            <div class="recorder-controls">
              <button type="button" id="start-recording" class="record-btn">
                <span class="icon">üé§</span>
                Start Recording
              </button>
              <button type="button" id="stop-recording" class="record-btn" disabled>
                <span class="icon">‚èπÔ∏è</span>
                Stop Recording
              </button>
            </div>
            <div id="recording-status" class="status"></div>
            <audio id="audio-playback" controls style="display: none;"></audio>
            <button type="button" id="upload-audio" class="upload-btn" disabled>
              Process Audio Recording
            </button>
          </div>
        </div>

        <!-- OCR Input Panel -->
        <div id="ocr-panel" class="input-panel">
          <div class="file-uploader">
            <h3>Document Scanner</h3>
            <p>Upload a patient ID card, form, or document to extract information.</p>
            <div class="upload-area" id="upload-area">
              <div class="upload-content">
                <span class="upload-icon">üìÅ</span>
                <p>Drag & drop files here or click to browse</p>
                <p class="upload-note">Supports: JPG, PNG, PDF (max 10MB)</p>
              </div>
              <input type="file" id="file-input" accept="image/*,.pdf" multiple style="display: none;">
            </div>
            <div id="upload-status" class="status"></div>
            <div id="file-preview"></div>
          </div>
        </div>

        <!-- Processing Results -->
        <div id="processing-results" class="processing-results" style="display: none;">
          <h3>Extracted Information</h3>
          <div id="extracted-data"></div>
          <div class="processing-actions">
            <button type="button" id="accept-extracted" class="accept-btn">Accept & Continue</button>
            <button type="button" id="edit-extracted" class="edit-btn">Edit Manually</button>
          </div>
        </div>
      </section>

      <section class="panel" id="wound-imaging-panel" style="display: none;">
        <div class="panel-header">
          <h2>Wound Imaging</h2>
          <span id="imaging-meta" class="meta"></span>
        </div>
        <p class="lead">Capture and upload wound photographs for clinical review.</p>

        <div class="imaging-interface">
          <div class="camera-controls">
            <h3>Take Photos</h3>
            <div class="camera-actions">
              <button type="button" id="start-camera" class="camera-btn">
                <span class="icon">üì∑</span>
                Start Camera
              </button>
              <button type="button" id="capture-photo" class="camera-btn" disabled>
                <span class="icon">üì∏</span>
                Capture Photo
              </button>
              <button type="button" id="stop-camera" class="camera-btn" disabled>
                <span class="icon">‚èπÔ∏è</span>
                Stop Camera
              </button>
            </div>
            <video id="camera-preview" autoplay playsinline style="display: none; width: 100%; max-width: 400px; border-radius: 8px; margin: 1rem 0;"></video>
            <canvas id="photo-canvas" style="display: none;"></canvas>
          </div>

          <div class="upload-alternative">
            <h3>Or Upload Photos</h3>
            <div class="upload-area" id="wound-upload-area">
              <div class="upload-content">
                <span class="upload-icon">üìÅ</span>
                <p>Drag & drop wound photos here or click to browse</p>
                <p class="upload-note">Supports: JPG, PNG (max 10MB each)</p>
              </div>
              <input type="file" id="wound-file-input" accept="image/*" multiple style="display: none;">
            </div>
          </div>

          <div class="photo-gallery" id="photo-gallery">
            <h3>Captured Photos</h3>
            <div class="gallery-grid" id="gallery-grid">
              <!-- Photos will be added here -->
            </div>
          </div>

          <div class="imaging-actions">
            <button type="button" id="confirm-imaging" class="confirm-btn" disabled>
              Complete Wound Imaging
            </button>
            <span id="imaging-status" class="status">No photos captured</span>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>Workflow Status</h2>
          <span id="session-phase" class="meta"></span>
        </div>
        <p class="lead">Tracks orchestrator steps as encrypted data syncs downstream.</p>
        <ol id="state-timeline" class="timeline"></ol>
      </section>

      <section class="panel">
        <h2>Missing Items</h2>
        <ul id="missing-fields" class="missing"></ul>
      </section>
    </main>

    <footer>
      <p>No clinical advice is ever provided by this application.</p>
    </footer>

    <script type="module" src="scripts/main.js"></script>
  </body>
</html>
